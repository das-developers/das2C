<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>das2C: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="das2logo-32.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">das2C
   </div>
   <div id="projectbrief">das2 core C utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">das2C Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><em>Das2</em> streams are a self-describing, streamable format that allows for the transmission of large and complex data sets between different systems and programming environments. A precise description of the Das Stream specification 2.2 is found elsewhere in the <em>das2</em> Interface Reference at <a href="https://github.com/das-developers/das2docs/tree/properties">https://github.com/das-developers/das2docs/tree/properties</a>. </p>
<p>This library of C functions provides utilities for more easily producing <em>das2</em> streams that are correctly formatted and will be compatible with future versions of the Das2 Stream specification. </p>
<h2>Writing Streams</h2>
<p>A das2 stream is created by first opening the stream and getting a handle to it, then calling functions of this library that create and send out the various entities that live in das2 streams. There are functions for creating a packetDescriptor and then specifying what data will be in each packet, functions for populating the fields of the packet and sending out the packet onto the stream. Also there are functions for indicating progress and sending out messages on the stream for human consumption. The top level stream writing functions are defined in output.h. </p>
<p>Here is an illustration of a typical use of the library: </p><ul>
<li>
Declare an output ::DasIO structure using new_DasIO_file() or new_DasIO_cfile().  </li>
<li>
Call new_StreamDesc() to create a ::StreamDesc structure.  </li>
<li>
Set global properties of the stream with the various ::DasDesc functions such as Desc_setPropString() and similar calls  </li>
<li>
Write out the stream descriptor using DasIO_writeStreamDesc()  </li>
<li>
Call new_PktDesc() to create a type of packet that will be found on the stream. Attach it to the stream using StreamDesc_addPktDesc()  </li>
<li>
Create the data planes for the packet using new_PlaneDesc() and new_PlaneDesc_yscan(). Attach them to the packet using PktDesc_addPlane().  </li>
<li>
Set extra properties such as labels for the data planes using DasDesc_setString() and similar functions.  </li>
<li>
Call DasIO_writePktDesc() to send the packet descriptor out onto the stream.  </li>
<li>
While reading through the records of input data do the following: <ul>
<li>
Call PlaneDesc_setValue() current values for each plane such as the current time and amplitudes.  </li>
<li>
Call DasIO_writePktData() to encode and output the current plane values  </li>
</ul>
</li>
<li>
close the stream using DasIO_close()  </li>
</ul>
<h2>Reading Streams</h2>
<p>A das2 stream is consumed by defining a set of callback functions that are invoked as the stream is read. Once the functions are set, program control is handed over to the library, and the callbacks are invoked until the entire stream is read. The top level stream reading functions are defined in input.h. </p>
<p>Here is an illustration of a typical use of the library to read a stream: </p><ol>
<li>
Declare an input ::DasIO structure using new_DasIO_file() or new_DasIO_cfile().  </li>
<li>
Declare a callback function of type <a class="el" href="processor_8h.html#ab047394150a8883592fd31cc3c231025" title="Definition of the callback function invoked when a stream header is encountered in the input.">StreamDescHandler</a> to be triggered when a new das2 stream header is read in.  </li>
<li>
Declare a callback function of type <a class="el" href="processor_8h.html#ab874ea026b9f5681ce20300c136fa29b" title="Definition of the callback function invoked when a packet header is encountered in the input.">PktDescHandler</a> for handling packet headers.  </li>
<li>
Declare a callback function of type <a class="el" href="processor_8h.html#a6ad0e615fadf3c723c60e6bda421acad" title="Callback function invoked when a data packet is encountered in the input.">PktDataHandler</a> for handling the incoming data packets.   </li>
<li>
Optionally declare functions for handling comments and exceptions. Often these are simply forwarded onto the output stream.  </li>
<li>
Fill out a <a class="el" href="interfaceStreamHandler.html" title="A set of callbacks used for input and output stream processing.">StreamHandler</a> structure to tie together your callbacks. <br  />
 If your callback functions need to maintain non-global state information use the StreamHandler::userData pointer to address a structure of your own design.  </li>
<li>
Call DasIO_readAll() to have the library read in the stream.  </li>
<li>
Exit after the DasIO_readAll() is completed.  </li>
</ol>
<h2>Example Program</h2>
<p>The program: </p><pre class="fragment">@b das2_bin_avg.c 
</pre><p>is a small filter for averaging das2 stream data into fixed size bins. Since it has to handle both input and output and does some minimal data processing, this short program provides a good example of using this library to read and write das2 streams.</p>
<h2>Compiling and Linking</h2>
<p>There are about a half-dozen or so library headers, but you don't need to worry about finding the right ones if you don't want to. A roll-up header is included with the library that will grab all definitions. So including the header: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="core_8h.html">das2/core.h</a>&gt;</span></div>
</div><!-- fragment --><p> in your application source files will define everything you need.</p>
<p>Linking is handled by command line options similar to: </p><div class="fragment"><div class="line">-L /YOUR/LIB/INSTALL/PATH -ldas2.3 -lfftw -lssl -lcrypto -lexpat -lpthread -lz -lm <span class="comment">// GCC</span></div>
<div class="line">/LIBPATH C:\YOUR\LIB\INSTALL\PATH das2.3.lib ssl.lib crypto.lib expat.lib libz.lib <span class="comment">// link.exe</span></div>
</div><!-- fragment --><p> The exact details depend on your C tool-chain and installation locations. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="ttc" id="acore_8h_html"><div class="ttname"><a href="core_8h.html">core.h</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
