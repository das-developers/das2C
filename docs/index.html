<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>libdas2: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="das2logo-32.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">libdas2
   </div>
   <div id="projectbrief">das2 core C utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">libdas2 Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Das2 Streams are a self-describing, streamable format that allows for the transmission of large and complex data sets between different systems and programming environments. A precise description of the Das Stream specification 2.2 is found elsewhere in the Das2 Interface Reference at <a href="http://www-pw.physics.uiowa.edu/das2">http://www-pw.physics.uiowa.edu/das2</a>. </p>
<p>This library of C functions provides utilities for more easily producing Das2 Streams that are correctly formatted and will be compatible with future versions of the Das2 Stream specification. </p>
<h2>Writing Streams</h2>
<p>A Das2 Stream is created by first opening the stream and getting a handle to it, then calling functions of this library that create and send out the various entities that live in Das2 Streams. There are functions for creating a packetDescriptor and then specifying what data will be in each packet, functions for populating the fields of the packet and sending out the packet onto the stream. Also there are functions for indicating progress and sending out messages on the stream for human consumption. The top level stream writing functions are defined in output.h. </p>
<p>Here is an illustration of a typical use of the library: </p>
<ul>
<li>
Declare an output <a class="el" href="structDasIO.html" title="Tracks input and output operations for das2 stream headers and data. ">DasIO</a> structure using <a class="el" href="structDasIO.html#a1fb607c4a454667442c0a49f0cd3f288" title="Create a new DasIO object from a disk file. ">new_DasIO_file()</a> or <a class="el" href="structDasIO.html#a75a5d8ec84a0b2c26257d370ca666fed" title="Create a new DasIO object from a standard C FILE. ">new_DasIO_cfile()</a>.  </li>
<li>
Call <a class="el" href="structStreamDesc.html#ac27b691d2a52437b7e5a2049d3088a9e" title="Creates a new blank StreamDesc. ">new_StreamDesc()</a> to create a <a class="el" href="structStreamDesc.html" title="Describes the stream itself, in particular the compression used, current packetDescriptors, etc. ">StreamDesc</a> structure.  </li>
<li>
Set global properties of the stream with the various <a class="el" href="structDasDesc.html" title="Base structure for Stream Header Items. ">DasDesc</a> functions such as Desc_setPropString() and similar calls  </li>
<li>
Write out the stream descriptor using <a class="el" href="structDasIO.html#a8374fb7cb37c7b80b2d9225aedc6e421" title="Writes the data describing the stream to the output channel (e.g. ">DasIO_writeStreamDesc()</a>  </li>
<li>
Call <a class="el" href="structPktDesc.html#adfcda4585cee753e26aa1ffdef8baa11" title="Creates a packet descriptor with the default settings. ">new_PktDesc()</a> to create a type of packet that will be found on the stream. Attach it to the stream using <a class="el" href="structStreamDesc.html#ada606ff8ed17123e05c5909c2cc437e4" title="Attach a standalone packet descriptor to this stream. ">StreamDesc_addPktDesc()</a>  </li>
<li>
Create the data planes for the packet using <a class="el" href="structPlaneDesc.html#a1041215cac5b8646669a7415c4fdcaf6" title="Creates a new X,Y or Z plane descriptor. ">new_PlaneDesc()</a> and <a class="el" href="structPlaneDesc.html#ac40853a4856cb1fc85ebc4967c27dead" title="Creates a new &lt;yscan&gt; plane descriptor. ">new_PlaneDesc_yscan()</a>. Attach them to the packet using <a class="el" href="structPktDesc.html#ac955e1cd55e5d0fb76e8d30588ea75c9" title="Add a plane to a packet. ">PktDesc_addPlane()</a>.  </li>
<li>
Set extra properties such as labels for the data planes using DasDesc_setString() and similar functions.  </li>
<li>
Call <a class="el" href="structDasIO.html#a2a670e6205c06e73817ddf2932c54a86" title="Writes the data describing a packet type to the output channel (e.g. ">DasIO_writePktDesc()</a> to send the packet descriptor out onto the stream.  </li>
<li>
While reading through the records of input data do the following: <ul>
<li>
Call <a class="el" href="structPlaneDesc.html#a06f74a857fff48409fa09ff42cd50991" title="Set a current value in a plane. ">PlaneDesc_setValue()</a> current values for each plane such as the current time and amplitudes.  </li>
<li>
Call <a class="el" href="structDasIO.html#a5f80abd99a68edfd2a5dd81a6406020f" title="Sends the data packet on to the stream after checking validity. ">DasIO_writePktData()</a> to encode and output the current plane values  </li>
</ul>
</li>
<li>
close the stream using <a class="el" href="structDasIO.html#a8442f1dd118a17cc58d2921b0c40060a" title="Normal stream close with no unusual condiditons Closes the output file descriptor, flushes a gzip buffer, etc. ">DasIO_close()</a>  </li>
</ul>
<h2>Reading Streams</h2>
<p>A Das2 Stream is consumed by defining a set of callback functions that are invoked as the stream is read. Once the functions are set, program control is handed over to the library, and the callbacks are invoked until the entire stream is read. The top level stream reading functions are defined in input.h. </p>
<p>Here is an illustration of a typical use of the library to read a stream: </p>
<ol>
<li>
Declare an input <a class="el" href="structDasIO.html" title="Tracks input and output operations for das2 stream headers and data. ">DasIO</a> structure using <a class="el" href="structDasIO.html#a1fb607c4a454667442c0a49f0cd3f288" title="Create a new DasIO object from a disk file. ">new_DasIO_file()</a> or <a class="el" href="structDasIO.html#a75a5d8ec84a0b2c26257d370ca666fed" title="Create a new DasIO object from a standard C FILE. ">new_DasIO_cfile()</a>.  </li>
<li>
Declare a callback function of type <a class="el" href="processor_8h.html#accfbd22229a797f16824526cfcb35b8f" title="Definition of the callback function invoked when a stream header is encountered in the input...">StreamDescHandler</a> to be triggered when a new das2 stream header is read in.  </li>
<li>
Declare a callback function of type <a class="el" href="processor_8h.html#a72277451b6e5e8284fa1c516b5ec98c3" title="Definition of the callback function invoked when a packet header is encountered in the input...">PktDescHandler</a> for handling packet headers.  </li>
<li>
Declare a callback function of type <a class="el" href="processor_8h.html#aa76b4f57cb19505c9439badf404efee9" title="Callback function invoked when a data packet is encountered in the input. ">PktDataHandler</a> for handling the incoming data packets.   </li>
<li>
Optionally declare functions for handling comments and exceptions. Often these are simply forwarded onto the output stream.  </li>
<li>
Fill out a <a class="el" href="structStreamHandler.html" title="A set of callbacks used for input and output stream processing. ">StreamHandler</a> structure to tie together your callbacks. If your callback functions need to maintain non-global state information use the <a class="el" href="structStreamHandler.html#a2e294dd14122c554baa0665072b4ca7a" title="An optional User-data pointer that is passed along to all callbacks. ">StreamHandler::userData</a> pointer to address a structure of your own design.  </li>
<li>
Call <a class="el" href="structDasIO.html#a80849c2166a65375a1107f5f548aec0c" title="Starts the processing of the stream read from FILE* infile. ">DasIO_readAll()</a> to have the library read in the stream.  </li>
<li>
Exit after the <a class="el" href="structDasIO.html#a80849c2166a65375a1107f5f548aec0c" title="Starts the processing of the stream read from FILE* infile. ">DasIO_readAll()</a> is completed.  </li>
</ol>
<h2>Example Program</h2>
<p>The program: </p>
<pre class="fragment">@b das2_bin_avg.c 
</pre><p>is a small filter for averaging Das2 Stream data into fixed size bins. Since it has to handle both input and output and does some minimal data processing, this short program provides a good example of using this library to read and write Das2 streams.</p>
<h2>Compiling and Linking</h2>
<p>There are about a half-dozen or so library headers, but you don't need to worry about finding the right ones if you don't want to. A roll-up header is included with the library that will grab all definitions. So including the header: </p>
<div class="fragment"><div class="line">*    #include &lt;das2/core.h&gt;</div>
<div class="line">* </div>
</div><!-- fragment --><p> in your application source files will define everything you need.</p>
<p>Linking is handled by command line options similar to: </p>
<div class="fragment"><div class="line">*   -L /YOUR/LIB/INSTALL/PATH -ldas2 -lexpat -lpthread -lz -lm <span class="comment">// GCC</span></div>
<div class="line">*   /LIBPATH C:\YOUR\LIB\INSTALL\PATH das2.lib expat.lib libz.lib <span class="comment">// link.exe</span></div>
<div class="line">* </div>
</div><!-- fragment --><p> The exact details depend on your C tool-chain and installation locations. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
