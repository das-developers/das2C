<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>libdas2: DFT</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="das2logo-32.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">libdas2
   </div>
   <div id="projectbrief">das2 core C utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">DFT</div>  </div>
</div><!--header-->
<div class="contents">

<p>Discrete Fourier transforms and power spectral density estimation.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Discrete Fourier transforms and power spectral density estimation. </p>
<p>This module provides an amplitude preserving 1-D Fourier transform and power preserving Power Spectral Density estimator. One key concept for this module is FFT plans can not be created and destroyed while transforms are running. On Linux the FFTW3 library is used to provide fast transform capability, the library to use for Windows is yet to be determined.</p>
<p>On linux if the file /etc/fftw/wisdom exists it will be loaded during the call to <a class="el" href="group__utilities.html#ga084423fd43637bf54496daf868147631" title="Initialize any global structures in the Das2 library. ">das_init()</a>. Pre-planning FFT operations can significantly increase the speed of new_DftPlan() calls</p>
<p>The following example uses the pthread library to demonstrate running four simultaneous transforms.</p>
<div class="fragment"><div class="line">* </div>
<div class="line">* #define SEC_IN_DAY 86400</div>
<div class="line">* #define FREQUENCIES (SEC_IN_DAY/2 + 1)</div>
<div class="line">* </div>
<div class="line">* <span class="comment">// I/O structure for worker threads</span></div>
<div class="line">* <span class="keyword">struct </span>thread_data {</div>
<div class="line">*   <a class="code" href="group__DFT.html#gaac4638b81c23c4e1d41ef753d65373a9">DftPlan</a>* pPlan;</div>
<div class="line">*   <span class="keywordtype">double</span>* pInput;</div>
<div class="line">*   <span class="keywordtype">double</span>* pOutput;</div>
<div class="line">* };</div>
<div class="line">* </div>
<div class="line">* <span class="keywordtype">void</span>* doTransform(<span class="keywordtype">void</span>* vpThreadData){</div>
<div class="line">*   <span class="keyword">struct </span>thread_data* pTd = (<span class="keyword">struct </span>thread_data*)vpThreadData;</div>
<div class="line">* </div>
<div class="line">*   <span class="comment">// DFT objects should be created on a per-thread basis</span></div>
<div class="line">*   <a class="code" href="structDas2Dft.html">Das2Dft</a>* pDft = <a class="code" href="group__DFT.html#ga119eec42f764aad046989815734c967b">new_Dft</a>(pTd-&gt;pPlan, <span class="stringliteral">&quot;HANN&quot;</span>);</div>
<div class="line">*   </div>
<div class="line">*   <span class="comment">// Run the transform saving the complex output to DFT obj memory</span></div>
<div class="line">*   <a class="code" href="group__DFT.html#ga63d35aa3ad36d563500616ad88565c20">Dft_calculate</a>(pDft, pTd-&gt;pInput, NULL);</div>
<div class="line">*</div>
<div class="line">*   <span class="comment">// Copy magnitude out to the location designated be the main thread</span></div>
<div class="line">*   <span class="keywordtype">size_t</span>* uLen = 0;</div>
<div class="line">*   <span class="keyword">const</span> <span class="keywordtype">double</span>* pMag = <a class="code" href="group__DFT.html#ga4c793f0efda647dcaff56c9c16274c18">Dft_getMagnitude</a>(pDft, &amp;uLen);</div>
<div class="line">*   assert(uLen == FREQUENCIES);</div>
<div class="line">*   memcpy(pTd-&gt;pOutput, pMag, uLen*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">* </div>
<div class="line">*   <a class="code" href="group__DFT.html#gaa4c9188e1d7523a39c3e62f8dee30028">del_Dft</a>(pDft);</div>
<div class="line">*   <span class="keywordflow">return</span> NULL;</div>
<div class="line">* }</div>
<div class="line">* </div>
<div class="line">* main(){</div>
<div class="line">*   </div>
<div class="line">*   <span class="comment">// Initialize libdas2</span></div>
<div class="line">*    <a class="code" href="group__utilities.html#ga084423fd43637bf54496daf868147631">das_init</a>(0, 0, DAS_LL_NOTICE, NULL);</div>
<div class="line">* </div>
<div class="line">*   <span class="keywordtype">double</span>* timeseries = (<span class="keywordtype">double</span>*) calloc(SEC_IN_DAY*4, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">*   </div>
<div class="line">*   <span class="comment">// Do something to fill time array ...</span></div>
<div class="line">*  </div>
<div class="line">*   <span class="keywordtype">double</span>* spectra = (<span class="keywordtype">double</span>*) calloc(FREQUENCIES*4, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">* </div>
<div class="line">*   <span class="comment">// Make a plan for calculating the DFTs</span></div>
<div class="line">*   <a class="code" href="group__DFT.html#gaac4638b81c23c4e1d41ef753d65373a9">DftPlan</a>* pPlan = new_DftPlan(SEC_IN_DAY, DAS2DFT_FORWARD, <span class="stringliteral">&quot;my_program&quot;</span>);</div>
<div class="line">* </div>
<div class="line">*   <span class="comment">// Now calculate 4 spectra at the same time</span></div>
<div class="line">*   <span class="keyword">struct </span>thread_data[4] = {NULL};</div>
<div class="line">*   pthread_t threads[4];</div>
<div class="line">*   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 4; ++i){</div>
<div class="line">*      thread_data[i].pPlan = pPlan;</div>
<div class="line">*      thread_data[i].pInput = timeseries + SEC_IN_DAY*i;</div>
<div class="line">*      thread_data[i].pOutput = spectra + FREQUENCIES*i;</div>
<div class="line">*      pthread_create(threads+i, NULL, doTransform, thread_data+i);</div>
<div class="line">*   }</div>
<div class="line">*   </div>
<div class="line">*   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 4; ++i) pthread_join(threads + i);</div>
<div class="line">*   </div>
<div class="line">*   del_DftPlan(pPlan);</div>
<div class="line">*   </div>
<div class="line">*   <span class="comment">// Do something with all 4 spectra ...</span></div>
<div class="line">*   </div>
<div class="line">* }</div>
<div class="line">* </div>
<div class="line">* </div>
</div><!-- fragment --> <table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDas2Dft.html">Das2Dft</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An amplitude preserving Discrete Fourier Transform converter.  <a href="structDas2Dft.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDas2Psd.html">Das2Psd</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A power spectral density estimator (periodogram)  <a href="structDas2Psd.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaac4638b81c23c4e1d41ef753d65373a9"><td class="memItemLeft" align="right" valign="top">typedef struct dft_plan&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#gaac4638b81c23c4e1d41ef753d65373a9">DftPlan</a></td></tr>
<tr class="memdesc:gaac4638b81c23c4e1d41ef753d65373a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">An structure containing a set of global planning data for DFTs to be preformed.  <a href="#gaac4638b81c23c4e1d41ef753d65373a9">More...</a><br/></td></tr>
<tr class="separator:gaac4638b81c23c4e1d41ef753d65373a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga38736f418cdb012dd5b5f1b63f204799"><td class="memItemLeft" align="right" valign="top">const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#ga38736f418cdb012dd5b5f1b63f204799">Dft_getReal</a> (<a class="el" href="structDas2Dft.html">Das2Dft</a> *pThis, size_t *pLen)</td></tr>
<tr class="memdesc:ga38736f418cdb012dd5b5f1b63f204799"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the real component after a calculation.  <a href="#ga38736f418cdb012dd5b5f1b63f204799">More...</a><br/></td></tr>
<tr class="separator:ga38736f418cdb012dd5b5f1b63f204799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga119eec42f764aad046989815734c967b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDas2Dft.html">Das2Dft</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#ga119eec42f764aad046989815734c967b">new_Dft</a> (<a class="el" href="group__DFT.html#gaac4638b81c23c4e1d41ef753d65373a9">DftPlan</a> *pPlan, const char *sWindow)</td></tr>
<tr class="memdesc:ga119eec42f764aad046989815734c967b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new DFT calculator.  <a href="#ga119eec42f764aad046989815734c967b">More...</a><br/></td></tr>
<tr class="separator:ga119eec42f764aad046989815734c967b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4c9188e1d7523a39c3e62f8dee30028"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#gaa4c9188e1d7523a39c3e62f8dee30028">del_Dft</a> (<a class="el" href="structDas2Dft.html">Das2Dft</a> *pThis)</td></tr>
<tr class="memdesc:gaa4c9188e1d7523a39c3e62f8dee30028"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a DFT (Discrete Fourier Transform) calculator.  <a href="#gaa4c9188e1d7523a39c3e62f8dee30028">More...</a><br/></td></tr>
<tr class="separator:gaa4c9188e1d7523a39c3e62f8dee30028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga63d35aa3ad36d563500616ad88565c20"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__utilities.html#ga9f7e3a196d85388e6fa0170ab7c39ff7">DasErrCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#ga63d35aa3ad36d563500616ad88565c20">Dft_calculate</a> (<a class="el" href="structDas2Dft.html">Das2Dft</a> *pThis, const double *pReal, const double *pImg)</td></tr>
<tr class="memdesc:ga63d35aa3ad36d563500616ad88565c20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a discrete Fourier transform.  <a href="#ga63d35aa3ad36d563500616ad88565c20">More...</a><br/></td></tr>
<tr class="separator:ga63d35aa3ad36d563500616ad88565c20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6fb5fc5816552c8d01e046dff19f2a5e"><td class="memItemLeft" align="right" valign="top">const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#ga6fb5fc5816552c8d01e046dff19f2a5e">Dft_getImg</a> (<a class="el" href="structDas2Dft.html">Das2Dft</a> *pThis, size_t *pLen)</td></tr>
<tr class="memdesc:ga6fb5fc5816552c8d01e046dff19f2a5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the imaginary component after a calculation.  <a href="#ga6fb5fc5816552c8d01e046dff19f2a5e">More...</a><br/></td></tr>
<tr class="separator:ga6fb5fc5816552c8d01e046dff19f2a5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c793f0efda647dcaff56c9c16274c18"><td class="memItemLeft" align="right" valign="top">const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#ga4c793f0efda647dcaff56c9c16274c18">Dft_getMagnitude</a> (<a class="el" href="structDas2Dft.html">Das2Dft</a> *pThis, size_t *pLen)</td></tr>
<tr class="memdesc:ga4c793f0efda647dcaff56c9c16274c18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the amplitude magnitude vector from a calculation.  <a href="#ga4c793f0efda647dcaff56c9c16274c18">More...</a><br/></td></tr>
<tr class="separator:ga4c793f0efda647dcaff56c9c16274c18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab84fe9c0ed1823a785e071071a733827"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDas2Psd.html">Das2Psd</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#gab84fe9c0ed1823a785e071071a733827">new_Psd</a> (<a class="el" href="group__DFT.html#gaac4638b81c23c4e1d41ef753d65373a9">DftPlan</a> *pPlan, bool bCenter, const char *sWindow)</td></tr>
<tr class="memdesc:gab84fe9c0ed1823a785e071071a733827"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new Power Spectral Density Calculator.  <a href="#gab84fe9c0ed1823a785e071071a733827">More...</a><br/></td></tr>
<tr class="separator:gab84fe9c0ed1823a785e071071a733827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac8836e2767dee4682dd0b3a8258d7bd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#gac8836e2767dee4682dd0b3a8258d7bd4">del_Das2Psd</a> (<a class="el" href="structDas2Psd.html">Das2Psd</a> *pThis)</td></tr>
<tr class="memdesc:gac8836e2767dee4682dd0b3a8258d7bd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a Power Spectral Density calculator.  <a href="#gac8836e2767dee4682dd0b3a8258d7bd4">More...</a><br/></td></tr>
<tr class="separator:gac8836e2767dee4682dd0b3a8258d7bd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabdef027bafa40a3bd64bd06c64448f88"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__utilities.html#ga9f7e3a196d85388e6fa0170ab7c39ff7">DasErrCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#gabdef027bafa40a3bd64bd06c64448f88">Psd_calculate</a> (<a class="el" href="structDas2Psd.html">Das2Psd</a> *pThis, const double *pReal, const double *pImg)</td></tr>
<tr class="memdesc:gabdef027bafa40a3bd64bd06c64448f88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a Power Spectral Density (periodogram)  <a href="#gabdef027bafa40a3bd64bd06c64448f88">More...</a><br/></td></tr>
<tr class="separator:gabdef027bafa40a3bd64bd06c64448f88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga09613ec8672b2eb75caeff9569d86138"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__utilities.html#ga9f7e3a196d85388e6fa0170ab7c39ff7">DasErrCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#ga09613ec8672b2eb75caeff9569d86138">Psd_calculate_f</a> (<a class="el" href="structDas2Psd.html">Das2Psd</a> *pThis, const float *pReal, const float *pImg)</td></tr>
<tr class="memdesc:ga09613ec8672b2eb75caeff9569d86138"><td class="mdescLeft">&#160;</td><td class="mdescRight">The floating point array input analog of Psd_calaculate()  <a href="#ga09613ec8672b2eb75caeff9569d86138">More...</a><br/></td></tr>
<tr class="separator:ga09613ec8672b2eb75caeff9569d86138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2d9bec419c03978110f7823574b79589"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#ga2d9bec419c03978110f7823574b79589">Psd_powerRatio</a> (const <a class="el" href="structDas2Psd.html">Das2Psd</a> *pThis, double *pInput, double *pOutput)</td></tr>
<tr class="memdesc:ga2d9bec419c03978110f7823574b79589"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide a comparison of the input power and the output power.  <a href="#ga2d9bec419c03978110f7823574b79589">More...</a><br/></td></tr>
<tr class="separator:ga2d9bec419c03978110f7823574b79589"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacb75a8b15328881d268cdda23c39860d"><td class="memItemLeft" align="right" valign="top">const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__DFT.html#gacb75a8b15328881d268cdda23c39860d">Psd_get</a> (const <a class="el" href="structDas2Psd.html">Das2Psd</a> *pThis, size_t *pLen)</td></tr>
<tr class="memdesc:gacb75a8b15328881d268cdda23c39860d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the amplitude magnitude vector from a calculation.  <a href="#gacb75a8b15328881d268cdda23c39860d">More...</a><br/></td></tr>
<tr class="separator:gacb75a8b15328881d268cdda23c39860d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="gaac4638b81c23c4e1d41ef753d65373a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct dft_plan <a class="el" href="group__DFT.html#gaac4638b81c23c4e1d41ef753d65373a9">DftPlan</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>An structure containing a set of global planning data for DFTs to be preformed. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga38736f418cdb012dd5b5f1b63f204799"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double* Dft_getReal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDas2Dft.html">Das2Dft</a> *&#160;</td>
          <td class="paramname"><em>pThis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>pLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the real component after a calculation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pThis</td><td></td></tr>
    <tr><td class="paramname">pLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a class="anchor" id="ga119eec42f764aad046989815734c967b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDas2Dft.html">Das2Dft</a> * new_Dft </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__DFT.html#gaac4638b81c23c4e1d41ef753d65373a9">DftPlan</a> *&#160;</td>
          <td class="paramname"><em>pPlan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sWindow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new DFT calculator. </p>
<p>This function allocates re-usable storage for Fourier transform output, but in order to preform calculations a re-usable plan object must be provided</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pPlan</td><td>- A Transform plan object. The reference count of DFTs using this plan will be incremented.</td></tr>
    <tr><td class="paramname">sWindow</td><td>- A named window to apply to the data. If NULL then no window will be used.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new <a class="el" href="structDas2Dft.html" title="An amplitude preserving Discrete Fourier Transform converter. ">Das2Dft</a> object allocated on the heap. </dd></dl>

</div>
</div>
<a class="anchor" id="gaa4c9188e1d7523a39c3e62f8dee30028"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void del_Dft </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDas2Dft.html">Das2Dft</a> *&#160;</td>
          <td class="paramname"><em>pThis</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free a DFT (Discrete Fourier Transform) calculator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pThis</td><td>the DFT calculator to free, the caller should set the object pointer to NULL after this call. Calling this also deletes the reference count for the associated DftPlan object </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga63d35aa3ad36d563500616ad88565c20"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__utilities.html#ga9f7e3a196d85388e6fa0170ab7c39ff7">DasErrCode</a> Dft_calculate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDas2Dft.html">Das2Dft</a> *&#160;</td>
          <td class="paramname"><em>pThis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>pReal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>pImg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate a discrete Fourier transform. </p>
<p>Using the calculation plan setup in the constructor, calculate a discrete Fourier transform. When this function is called internal storage of any previous DFT calculations (if any) are over written.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pThis</td><td>The DFT object which will hold the result memory</td></tr>
    <tr><td class="paramname">pReal</td><td>An input vector of with the same length as the plan object provided to the constructor</td></tr>
    <tr><td class="paramname">pImg</td><td>The imaginary (or quadrature phase) input vector with the same length as pRead. For a purely real signal this vector is NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (DAS_OKAY) if the calculation was successful, a non-zero error code otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="ga6fb5fc5816552c8d01e046dff19f2a5e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double * Dft_getImg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDas2Dft.html">Das2Dft</a> *&#160;</td>
          <td class="paramname"><em>pThis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>pLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the imaginary component after a calculation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pThis</td><td></td></tr>
    <tr><td class="paramname">pLen</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a class="anchor" id="ga4c793f0efda647dcaff56c9c16274c18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double * Dft_getMagnitude </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDas2Dft.html">Das2Dft</a> *&#160;</td>
          <td class="paramname"><em>pThis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>pLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the amplitude magnitude vector from a calculation. </p>
<p>Scale the stored DFT so that it preserves amplitude, and get the magnitude. For real-valued inputs (complex pointer = 0) the 'positive' and 'negative' frequencies are combined. For complex input vectors this is not the case since all DFT output amplitudes are unique. Stated another way, for complex input signals components above the Nyquist frequency have meaningful information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pThis</td><td>The DFT calculator object which has previously been called to calculate a result.</td></tr>
    <tr><td class="paramname">pLen</td><td>The vector length. In general this is <em>NOT</em> the same as the input time series length. For real-value input signals (complex input is NULL, this is N/2 + 1. For complex input signals this is N.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to an internal holding bin for the real signal magnitude values.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>If <a class="el" href="group__DFT.html#ga63d35aa3ad36d563500616ad88565c20" title="Calculate a discrete Fourier transform. ">Dft_calculate()</a> is called again, the return pointer can be invalidated. If a permanent result is needed after subsequent <a class="el" href="group__DFT.html#ga63d35aa3ad36d563500616ad88565c20" title="Calculate a discrete Fourier transform. ">Dft_calculate()</a> calls, copy these data to another buffer. </dd></dl>

</div>
</div>
<a class="anchor" id="gab84fe9c0ed1823a785e071071a733827"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDas2Psd.html">Das2Psd</a> * new_Psd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__DFT.html#gaac4638b81c23c4e1d41ef753d65373a9">DftPlan</a> *&#160;</td>
          <td class="paramname"><em>pPlan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bCenter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sWindow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new Power Spectral Density Calculator. </p>
<p>This estimator uses the equations given in Numerical Recipes in C, section 13.4, but not any of the actual Numerical Recipes source code.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pPlan</td><td>- A Transform plan object. The reference count of DFTs using this plan will be incremented.</td></tr>
    <tr><td class="paramname">bCenter</td><td>If true, input values will be centered on the Mean value. This shifts-out the DC component from the input.</td></tr>
    <tr><td class="paramname">sWindow</td><td>A named window to use for the data. Possible values are: "hann" - Use a hann window as defined at <a href="http://en.wikipedia.org/wiki/Hann_function">http://en.wikipedia.org/wiki/Hann_function</a> NULL - Use a square window. (i.e. 'multiply' all data by 1.0)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new Power Spectral Density estimator allocated on the heap </dd></dl>

</div>
</div>
<a class="anchor" id="gac8836e2767dee4682dd0b3a8258d7bd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void del_Das2Psd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDas2Psd.html">Das2Psd</a> *&#160;</td>
          <td class="paramname"><em>pThis</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free a Power Spectral Density calculator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pThis</td><td>the PSD calculator to free, the caller should set the object pointer to NULL after this call. Calling this also deletes the reference count for the associated DftPlan object </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gabdef027bafa40a3bd64bd06c64448f88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__utilities.html#ga9f7e3a196d85388e6fa0170ab7c39ff7">DasErrCode</a> Psd_calculate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDas2Psd.html">Das2Psd</a> *&#160;</td>
          <td class="paramname"><em>pThis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>pReal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>pImg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate a Power Spectral Density (periodogram) </p>
<p>Using the calculation plan setup in the constructor, calculate a discrete Fourier transform. When this function is called internal storage of any previous DFT calculations (if any) are over written.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pThis</td><td>The PSD calculator object</td></tr>
    <tr><td class="paramname">pReal</td><td>An input vector of with the same length as the plan object provided to the constructor</td></tr>
    <tr><td class="paramname">pImg</td><td>The imaginary (or quadrature phase) input vector with the same length as pRead. For a purely real signal this vector is NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (DAS_OKAY) if the calculation was successful, a non-zero error code otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="ga09613ec8672b2eb75caeff9569d86138"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__utilities.html#ga9f7e3a196d85388e6fa0170ab7c39ff7">DasErrCode</a> Psd_calculate_f </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDas2Psd.html">Das2Psd</a> *&#160;</td>
          <td class="paramname"><em>pThis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>pReal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>pImg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The floating point array input analog of Psd_calaculate() </p>
<p>Internal calculations are still handled in double precision. </p>

</div>
</div>
<a class="anchor" id="ga2d9bec419c03978110f7823574b79589"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Psd_powerRatio </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structDas2Psd.html">Das2Psd</a> *&#160;</td>
          <td class="paramname"><em>pThis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pInput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pOutput</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide a comparison of the input power and the output power. </p>
<p>During the <a class="el" href="group__DFT.html#gabdef027bafa40a3bd64bd06c64448f88" title="Calculate a Power Spectral Density (periodogram) ">Psd_calculate()</a> call the average magnitude of the input vector is saved along with the average magnitude of the output vector (divided by the Window summed and squared). These two measures of power should always be close to each other when using a hann window. When using a NULL window they should be almost identical, to within rounding error. The two measures are:</p>
<pre>
             N-1
         1  ----   2      2
 Pin =  --- \    r    +  i
         N  /     n       n
            ----
             n=0</pre><pre>               N-1
          1   ----   2      2
 Pout =  ---  \    R    +  I
         Wss  /     k       k
              ----
               k=0
</pre><p>where Wss collapses to N**2 when a NULL (square) window is used. The reason that the Pout has an extra factor of N in the denominator is due to the following identity for the discrete Fourier transform (Parseval's theorem): </p>
<pre></pre><pre>    N-1                   N-1
   ----   2    2      1  ----  2    2
   \     r  + i   =  --- \    R  + I
   /      n    n      N  /     n    n
   ----                  ----
    n=0                   k=0</pre><pre></pre><p> Where r and i are the real and imaginary input amplitudes, and R and I are the DFT real and imaginary output values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pThis</td><td>A PSD calculator for which Psd_calculate has been called</td></tr>
    <tr><td class="paramname">pInput</td><td>A pointer to store the input power. If NULL, the input power will no be saved separately.</td></tr>
    <tr><td class="paramname">pOutput</td><td>A pointer to store the output power. If NULL, the output power will no be saved separately.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The ratio of Power Out divided by Power In. (Gain). </dd></dl>

</div>
</div>
<a class="anchor" id="gacb75a8b15328881d268cdda23c39860d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double * Psd_get </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structDas2Psd.html">Das2Psd</a> *&#160;</td>
          <td class="paramname"><em>pThis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>pLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the amplitude magnitude vector from a calculation. </p>
<p>Scale the stored DFT so that it preserves amplitude, and get the magnitude. For real-valued inputs (complex pointer = 0) the 'positive' and 'negative' frequencies are combined. For complex input vectors this is not the case since all DFT output amplitudes are unique. Stated another way, for complex input signals components above the Nyquist frequency have meaningful information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pThis</td><td>The DFT calculator object which has previously been called to calculate a result.</td></tr>
    <tr><td class="paramname">pLen</td><td>The vector length. In general this is <em>NOT</em> the same as the input time series length. For real-value input signals (complex input is NULL, this is N/2 + 1. For complex input signals this is N.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to an internal holding bin for the real signal magnitude values.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>If <a class="el" href="group__DFT.html#gabdef027bafa40a3bd64bd06c64448f88" title="Calculate a Power Spectral Density (periodogram) ">Psd_calculate()</a> is called again, the return pointer can be invalidated. If a permanent result is needed after subsequent <a class="el" href="group__DFT.html#gabdef027bafa40a3bd64bd06c64448f88" title="Calculate a Power Spectral Density (periodogram) ">Psd_calculate()</a> calls, copy these data to another buffer. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
